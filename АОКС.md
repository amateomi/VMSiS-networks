## 1. Назначение и структура сетевых адаптеров

Сетевые адаптеры - Network Interface Cards (NICs) предназначены для подключения пользовательских станций, то есть клиентских и серверных компьютеров, к КС.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/b30045a1-c441-4c49-9540-d5c0be013c7d)

1. Блок индикации (LED)
2. Разъем для подключения к СрПД
3. Приемопередатчик
4. Сетевой контроллер
5. Блок перемычек
6. ПЗУ для хранения настроек по умолчанию
7. Гнездо для boot ROM либо boot ROM
8. Разъем для подключения к шине расширения компьютера (PCI либо другая)

## 2. Соответствие компонентов сетевых адаптеров модели OSI

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/02191804-ea41-4c37-9d0c-926f5724db21)

- AUI - Attachment Unit Interface
- MII - Medium Independent Interface
- MDI - Medium Dependent Interface
- GMII - Gigabit MII

Блок PHY (PHYsical), он же трансивер, не обязательно интегрирован в кристалл контроллера - он может быть изготовлен на основе отдельной микросхемы.

## 3. Характеристики и критерии выбора сетевых адаптеров

1. СрПД
2. Область применения: desktop, server, mobile
3. Степень интеграции: add-on, on-board
4. Управляемость: management, unmanagement
5. Режим работы: half duplex, full duplex
6. Технические характеристики: размеры буферов и так далее
7. Количество предоставляемых сетевых интерфейсов: single, dual, quad
8. Дополнительные возможности: аппаратная поддержка шифрования, сбор статистики и другое
9. Возможности энергосбережения: ACPI, WOL и другие
10. Вариант поставки: OEM, Retail

## 4. Поколения сетевых адаптеров

| Шина            | Битность | Управление    | Кабель                                    |
| --------------- | -------- | ------------- | ----------------------------------------- |
| XT              | 8        | перемычки     | толстый коаксиальный                      |
| ISA             | 16       | перемычки     | тонкий коаксиальный                       |
| ISA/PCI         | 16/32    | перемычки/PNP | тонкий коаксиальный/витая пара            |
| PCI             | 32       | PNP           | витая пара (Fast Ethernet)                |
| PCI/PCI-Express | 32/64    | PNP           | витая пара/оптоволокно (Gigabit Ethernet) |

## 5. Назначение и классификация пассивного сетевого оборудования

Пассивное сетевое оборудование - сетевое оборудование, предназначенное не для анализа передаваемой информации, а для обеспечения требующихся технических характеристик.

Классификация:

1. Концентраторы (hubs) - работают с сигналами на физическом уровне модели OSI и тем самым осуществляют передачу принимаемых пакетов во всех направлениях
2. Повторители (repeaters) - осуществляют усиление принимаемых сигналов
3. Приемопередатчики (transceivers) - подключают к коммутаторам и маршрутизаторам посредством стандартных разъемов (AUI, MII, GBIC, SFP), осуществляют передачу пакетов в определенные СрПД и прием пакетов из них
4. Модули (modules) - оригинальные (как правило) модули маршрутизаторов и коммутаторов
5. Медиаконвертеры (mediaconverters) - осуществляют преобразование СрПД (например, из коаксиального кабеля в витую пару и наоборот)
6. Фильтры, сплиттеры и сумматоры - осуществляют выделение, подавление, разделение и объединение диапазонов частот

## 6. Назначение и классификация активного сетевого оборудования

Активное сетевое оборудование - сетевое оборудование, способное анализировать передаваемую информацию.

Классификация:

1. Коммутаторы (switches) - работают на втором уровне модели OSI и осуществляют целевую передачу принятых пакетов (кадров) в единственных правильных направлениях (в пределах сегментов)
2. Маршрутизаторы (routers) - работают на третьем уровне модели OSI и осуществляют передачу принятых пакетов в соответствии с маршрутной информацией
3. Шлюзы (gateways) - осуществляют «перенаправление» сетевых сервисов прикладного уровня

## 7. Структура коммутатора и методы коммутации

С точки зрения структуры коммутаторы делятся на:

1. На основе коммутационной матрицы (crossbar fabric) - пакеты между портами проходят по выделенным путям, проложенным через коммутационную матрицу
2. На основе разделяемой шины (bus backplane) - пакеты проходят через связывающую все порты общую высокоскоростную шину
3. На основе разделяемой памяти (shared memory) - пакеты перемещаются между портами посредством размещения в общей для всех портов памяти

Методы коммутации:

1. Store & Forward - с промежуточной буферизацией - коммутатор получает пакет полностью перед его ретрансляцией; анализируется адрес назначения и проверяется контрольная сумма
2. Cut Through - без промежуточной буферизации - коммутатор не ожидает получения пакета целиком; анализируется лишь адрес назначения
3. Fragment Free - модифицированный метод с промежуточной буферизацией - перед тем как осуществить коммутацию, коммутатор ожидает получение первых 64 байтов пакета; таким образом, если в пакете присутствует ошибка, то она почти всегда обнаруживается путем анализа этих байтов
4. Hybrid - гибридный - поочередное адаптивное применение перечисленных методов

## 8. Структура таблицы коммутатора Ethernet и ее использование

В основу работы классического коммутатора второго уровня положена таблица MAC-адресов, по-другому называемая CAM-таблицей (Content Addressable Memory). В таблице хранится соответствие MAC-адресов и портов.

При приеме юникаст-кадра некоторым портом, коммутатор связывает MAC-адрес источника с номером этого порта и заносит в таблицу (этот процесс называют изучением). При ретрансляции кадра порт для передачи определяется исходя из MAC-адреса назначения по таблице. Широковещательный кадр и кадр с еще незнакомым юникаст-MAC-адресом назначения ретранслируются всеми портами.

При ретрансляции пакетов (Smart-коммутаторами) учитываются виланы.

MAC-адреса в CAM-таблице коммутатора могут быть двух видов:
1. Динамические (dynamic) - изучаются коммутатором автоматически
2. Статические (static) - администратор «вручную» привязывает их к портам по одному или по несколько

## 9. Гибридные технологии L2-L3

Гибридные коммутаторы способны анализировать пакеты L3 уровня.

Выделяют 3 типа коммутаторов L3 уровня:

1. Маршрутизирующие коммутаторы (routing switches) - направление ретрансляции определяется на основе анализа информации, относящейся к третьему уровню в заголовке пакета; от маршрутизаторов отличаются виртуальностью сетевых интерфейсов
2. Коммутаторы потоков (flow switches) - выполняются попытки обнаружить продолжительные потоки пакетов между двумя станциями; после того, как факт наличия потока установлен на третьем уровне, дальнейшая коммутация осуществляется традиционным способом
3. Коммутирующие маршрутизаторы (switching routers) - выполняются попытки снизить расчетную нагрузку с маршрутизатора и возложить часть функций на уровень коммутации

## 10. Характеристики и критерии выбора активного сетевого оборудования

1. Область применения: workgroup - для рабочих групп, backbone (core) - магистральные
2. Тип и число физических портов: 4 (+1), 8, 12, 16, 24, 48 (другие редко)
3. Уровень модели OSI: L2, L2+, L3, L3+
4. Набор поддерживаемых протоколов маршрутизации (для L3-устройств)
5. Управляемость: unmanaged - неуправляемые, managed - управляемые (свой IP адрес, выделенная консоль RS-232, web-интерфейс, SNMP)
6. Структура: fixed - фиксированная, modular - модульная
7. Возможность масштабирования: unstackable - нестекируемые, stackable - стекируемые
8. Наличие разъемов расширений: стандартные, оригинальные
9. Технические характеристики: размеры таблиц, времена задержек и другие
10. Суммарная пропускная способность
11. Возможность автоматического определения скорости и режима (физического соединения): auto-negotiation и auto-MDI/MDIX.
12. Поддержка виртуальных ЛКС: VLANs
13. Поддержка резервирования: spanning tree, link aggregation, clusters
14. Поддержка дополнительных возможностей по обеспечению безопасности: port security и access control lists
15. Поддержка качества обслуживания: QoS

## 11. Производители сетевого оборудования различных категорий

High-end:

- Intel
- HP
- Aruba
- Cisco (множество серий коммутаторов Catalyst и маршрутизаторов)
- Nortel
- Nokia
- Juniper
- Allied Telesis
- Zyxel
- Broadcom

Low-end:

- Huawei
- D-Link
- Realtek
- Surecom

## 12. Коммутаторы Cisco

Коммутаторы Cisco делят на следующие категории:

1. Access
2. Core and distribution
3. Data center and cloud
4. Industrial Ethernet
5. Small business and LAN compact

Основу всех трех основных сегментов рынка (SOHO, SMB, Enterprise) составляют различные серии флагманских коммутаторов Catalyst. Для сегмента рынка SOHO доступны несколько серий не Catalyst-коммутаторов, которые немного дешевле, но поддерживают все основные возможности. Для центров обработки данных есть серия коммутаторов Nexus, с портами до 100 Gbit/s и low latency (системы реального времени).

Программа CCNA ориентирована в первую очередь на коммутаторы 2960 и их разновидности.

Есть модульные и немодульные, стекируемые и нестекируемые.

AUX-порты в коммутаторы Cisco не устанавливают. У относительно дешевых коммутаторов нет тумблеров питания.

Отдельно взятый порт отдельно взятого коммутатора Cisco имеет традиционно совмещенный двухцветный (зеленый и оранжевый) индикатор. Для переключения режима индикации используют кнопку Mode, расположенную на лицевой панели.

## 13. Cisco IOS и коммутаторы

В настоящее время наиболее актуальны следующие версии IOS для коммутаторов:

- 12.2 - для 2960, 3560, 3750 и других «современников»
- 15.X - для 2960, 2960-S, 3560-X, 3750-X, 2960-L, 1000 и других
- 16.X (IOS XE) - для 3650, 3850, 9200, 9300 и других

Коммутаторы серии 2960 поставляли со встроенным web-интерфейсом. Не Catalyst коммутаторы вовсе не имеют CLI («младшие» серии) либо имеют упрощенный CLI, называемый Textview («старшие» серии), зато имеют полноценный встроенный web-интерфейс.

IOS XE более громоздкая по сравнению с IOS, на коммутатор её можно установить в двух режимах: install (не доступен на маршрутизаторах) и bundle

Нумерация интерфейсов на коммутаторах начинается с единицы, а не с нуля (gi0/1), как на маршрутизаторах.

## 14. Конфигурирование порта Ethernet коммутатора Cisco

Параметры Ethernet порта коммутатора по-умолчанию:

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/452b3cd9-3802-4b6a-b5bf-f75e066a2a05)

Некоторые команды:

```
Switch(config)#interface range gi0/1,gi0/11-12
Switch(config-if-range)#speed 1000
Switch(config-if-range)#duplex full
Switch(config-if-range)#mdix auto
Switch(config-if-range)#flowcontrol receive on ! Включить flow control (элемент QoS)
Switch(config-if-range)#power inline never ! Отключить PoE
Switch(config-if-range)#exit
```

## 15. Таблица коммутатора Cisco 2960

Рассказать как устроена CAM-таблица.

Для привязки статических MAC-адресов к портам используют команду mac-address-table static:

```
Switch(config)#mac-address-table static 12ab.47dd.ff89 vlan 1 interface fa0/1
```

Для просмотра CAM-таблицы используют команду show mac address-table:

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/3488e92f-2125-4754-af21-96244efcea8f)

## 16. Понятие виланов, их достоинства и недостатки

Виланы позволяют строить на базе одной физической сети некоторое количество логических, причем логические сети будут существовать независимо друг от друга, то есть переданный в одной сети пакет никогда не будет принят в другой (если дополнительно об этом не позаботиться).

Пример организации виланов:

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/8cf376cf-4897-4c05-b01c-3a39c4a269c8)

Основные достоинства виланов:

1. Использование виланов помогает контролировать трафик, в первую очередь широковещательный
2. С помощью виланов обеспечивают дополнительную защиту информации
3. Виланы лучше адаптированы к изменениям в составе сетевого оборудования

Основные недостатки виланов:

1. Необходимость наличия значительно более дорогостоящего сетевого оборудования (например, сетевые адаптеры типа server и коммутаторы не ниже уровня L2+)
2. Применение виланов приводит к увеличению вычислительной нагрузки по причине вносимых количественных и качественных дополнений

## 17. Классификации и реализации виланов

При рассмотрении виланов выделяют три группы понятий:

1. Физические порты (physical ports), то есть точки подключения сетевого оборудования (сетевых адаптеров, коммутаторов и другого)
2. Физические соединения (каналы) (links) между физическими портами
3. Виртуальные сетевые интерфейсы и подинтерфейсы (subinterfaces) сетевого оборудования

Критерии классификации виланов:

1. Порт-, интерфейс- либо канал-ориентированность: port-based, interface-based, link-based
2. Наличие тегировки пакетов: tagged, untagged
3. Наличие протокол-ориентированности (адрес-ориентированности): protocol-based
4. Уровень модели OSI: L2, L3 и другие
5. Наличие аутентификации: authentication-based
6. Постоянство членства: static, dynamic

Основные реализации виланов:

1. Собственно Port-based - членство в вилане определяется в соответствии с портами активного сетевого оборудования

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/a1b31f25-231b-4374-80dd-9d50209ad6d9)

2. 802.1Q - в кадр Ethernet вставляется специальный тег
3. Cisco ISL (Inter-Switch Link) - проприетарный протокол, аналогичный 802.1Q
4. Cisco VTP (VLAN Trunking Protocol) - проприетарный протокол, позволяющий частично автоматизировать настройку виланов

## 18. 802.1Q

802.1Q - реализация виланов на основе тегов, вставляемых в кадр Ethernet:

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/4e0fcf4f-327e-440d-9df8-6ac40d6cfeca)

1. TPID (Tag Protocol IDentifier) - идентификатор протокола тегировки (является и признаком наличия тега, для 802.1Q равно 8100h)
2. PCP (Priority Code Point) - код приоритета либо приоритет пользователя
3. DEI (Drop Eligible Indicator) - индикатор разрешения отброса кадра либо индикатор канонического формата MAC-адреса (в обычном кадре Ethernet равно нулю)
4. VID (VLAN IDentifier) - идентификатор вилана (собственно значение тега)

Классификация виланов в рамках 802.1Q:

1. Data VLAN - «рабочий» вилан - предназначен для передачи пользовательского трафика (может быть назначен любой незарезервированный VID)
2. Default VLAN - вилан по умолчанию - в данный вилан включаются все порты коммутатора по умолчанию (не может быть ни изменен, ни удален; зарезервирован VID = 1)
3. Management VLAN - административный вилан - предназначен для администрирования (выделяют исходя из соображений безопасности; от пользовательских виланов отличается только назначением)
4. Native VLAN - вилан для оригинального трафика - предназначен для передачи нетегированного трафика (по умолчанию это вилан с VID = 1; может быть назначен любой незарезервированный VID)
5. Private VLAN - приватный вилан - предназначен для частичного запрета трафика в рамках вилана (позволяет масштабировать виланы)
6. Reserved VLAN - зарезервированный вилан - предназначен для передачи специфического трафика (например, голосового; VID может быть как из зарезервированного, так и с незарезервированного диапазона)

Концепция 802.1Q допускает многократную тегировку кадров (QinQ), но нужно помнить что каждый тег увеличивает кадр, а значит длина кадра может превысить значение MTU. Сетевое оборудование обрабатывает теги, находящиеся «на вершине» (наиболее близкие к началу кадра).

*Рассказать про access и trunk порты.*

## 19. Маршрутизация между виланами

Каждый вилан является сегментом сети, а значит соответствует IP-подсети. Для взаимодействия между разными виланами необходима маршрутизация между виланами (inter-VLAN routing).

Маршрутизация между виланами может выполняться:

1. L3-коммутатором с виртуальными сетевыми интерфейсами в разных IP-подсетях

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/a4a902cc-a63c-4703-9dac-caa96cadf5d4)

2. Маршрутизатором с относящимися к разным IP-подсетям виртуальными подинтерфейсами одного реального сетевого интерфейса (иногда называют router-on-stick)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/cfc03b45-9c1d-4f79-a143-7589f3caab75)

3. Маршрутизатором с относящимися к разным IP-подсетям сетевыми интерфейсами (иногда называют классической маршрутизацией между виланами)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/058ac959-6ce4-4ecb-89a2-69d09c53dfbf)

## 20. Поддержка виланов в Windows и Linux

В Windows, исключая Server 2012 - Server 2019, виланы поддерживаются только на уровне драйверов сетевых адаптеров (например, Intel). При этом необходимо конфигурационное ПО (например, утилиты) от производителей.

Подинтерфейсы как таковые не поддерживаются.

Виланы представлены виртуальными мультиплексируемыми сетевыми интерфейсами, их можно посмотреть и настроить через диспетчер устройств.

В Linux поддержка виланов выражена в подинтерфейсах. На примере eth0 - это eth0.1, eth0.2, eth0.3 и так далее. Номер подинтерфейса соответствует VID в кадре (тегированный трафик), eth0 соответствует native VLAN (нетегированный трафик). Подинтерфейсы eth0 могут сосуществовать с eth0.

В разных дистрибутивах Linux настройка сетевых интерфейсов выглядит по разному. Пример конфигурации в Debian через файл `/etc/network/interfaces`

```
auto eth1.10
iface eth1.10 inet static
  address 192.168.10.1
  netmask 255.255.255.0
  vlan_raw_device eth1
```

## 21. Конфигурирование виланов в IOS

Пример создания пользовательского вилана:

```
Switch>enable
Switch#configure terminal
Switch(config)#vlan 10
Switch(config-vlan)#name cool-vlan-name
```

Пример назначения порта доступа:

```
Switch(config)#interface fa0/1
Switch(config-if)#switchport mode access
Switch(config-if)#switchport access vlan 10
```

Если кроме 802.1Q поддерживается ISL (как на 3560), то по умолчанию происходит автосогласование типа инкапсуляции. Рекомендуется использовать команду `switchport trunk encapsulation dot1q` для явного указания.

Пример назначения транкового порта:

```
Switch(config)#interface fa0/2
Switch(config-if)#switchport mode trunk
Switch(config-if)#switchport trunk encapsulation dot1q
Switch(config-if)#switchport trunk allowed vlan 10,20,30,40
Switch(config-if)#switchport trunk native vlan 40
```

Кроме статического задания транка, существует возможность его динамического формирования с помощью протокола DTP (Dynamic Trunking Protocol). Таким образом у транкового порта может быть несколько режимов: `dynamic auto`, `dynamic desirable` и `trunk`. Выбор динамического режима происходит через команду `switchport mode`.

Итоговое состояние линка между двумя портами коммутатора в различных комбинациях режимов портов:

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/2408f5df-4a64-428b-b51d-094b2a74cab5)

## 22. Конфигурирование маршрутизации между виланами в IOS

Конфигурирование маршрутизации между виланами можно осуществлять с помощью SVI (Switch Virtual Interface) (обычно на L3 коммутаторах), подинтерфейсов (обычно при router-on-stick).

Пример настройки SVI:

```
Switch(config)#interface vlan 10
Switch(config-if)#ip address 192.168.0.11 255.255.255.0
Switch(config-if)#no shutdown
```

Пример настройки подинтерфейса:

```
Router(config)#interface gi0/0.1
Router(config-subif)#encapsulation dot1q 10
Router(config-subif)#ip address 192.168.0.2 255.255.255.0
```

По умолчанию на L3 коммутаторах маршрутизация выключена. Если есть потребность указать шлюз по умолчанию, но другие маршруты не нужны, то можно воспользоваться командой:

```
Switch(config)#ip default-gateway 192.168.0.1
```

В обратном случае маршрутизация настраивается так:

```
Switch(config)#ip routing
Switch(config)#ip route 0.0.0.0 0.0.0.0 192.168.0.1
```

Для просмотра информации о виланах в основном используют команду show vlan с опциональным указанием VID либо названия интересующего вилана. Можно использовать и команду show interfaces.

## 23. Протокол VTP и его использование

Основное назначение протокола второго уровня VTP (VLAN Trunking Protocol) заключается в автоматизации процесса передачи информации о виланах в рамках одного домена. VTP является проприетарным протоколом Cisco.

VTP-домен (VTP domain) представляет собой единую зону ответственности, работающую по правилам протокола VTP и состоящую из некоторого количества соединенных между собой коммутаторов. В рамках СПД может существовать несколько VTP-доменов. Каждый VTP-домен уникальным образом именуют. Коммутатор может входить в состав только одного VTP-домена. Разработаны три версии протокола VTP: 1, 2 и 3. В границах VTP-домена допускается применение только одной версии.

Коммутаторы в рамках VTP имеют следующие режимы:

1. Сервер - создает, модифицирует и удаляет виланы, задает конфигурацию для всего домена, все изменения распространяются по домену в виде специальных сообщений. В домене только один сервер
2. Клиент - получает информацию о виланах от сервера
3. Прозрачный - не участвует в работе домена, с которым связан (в VTPv2 ретранслируют VTP сообщения)

При каждом обновлении информации о виланах в домене инкриминируется специальный ревизионный номер. Этот номер можно сбросить при смене имени домена.

Виды VTP сообщений:

1. Summary - содержат обобщенную информацию, порождаются сервером и распространяются по всему домену, посылаются незамедлительно при любых изменениях и затем периодически с интервалом равным 5 min (интервал изменить нельзя), также посылаются по запросу.
2. Subset - содержат информацию о виланах, порождаются сервером и распространяются по всему домену, посылаются при любых изменениях или по запросу, при необходимости фрагментируются.
3. Request (+Join) - запросы от клиентов к серверу о конфигурации, посылаются при подключении клиентов к домену, также посылаются если текущий ревизионный номер меньше полученного посредством summary или произошла потеря subset, в ответ сервер посылает summary плюс одно либо несколько subset.

Если по каким-либо причинам в домен попал VTP-клиент с ревизионным номером больше чем у сервера, то возникает исключительная ситуация, и, благодаря скрытым механизмам, клиент на время становится сервером. В результате, его конфигурация «разносится» по домену, что обычно неправильно.

Если VTP-пароли задаются, то в пределах домена они должны быть идентичными.

VTP, с одной стороны, избавляет от рутинной ручной работы, но, с другой стороны, порождает избыточность. Усовершенствование под названием VTP-сдерживание (VTP pruning) препятствует распространению по транкам относящегося к определенным виланам трафика в ненужных направлениях, тем самым увеличивая эффективность СПД.

## 24. Конфигурирование VTP

Пример конфигурации VTP сервера:

```
Switch(config)#vtp mode server
Switch(config)#vtp domain very-cool-domain
Switch(config)#vtp password extremely-strong-and-complicated-password
```

Пример конфигурации VTP клиента:

```
Switch(config)#vtp mode client
Switch(config)#vtp domain very-cool-domain
Switch(config)#vtp password extremely-strong-and-complicated-password
```

Пример конфигурации VTP transparent:

```
Switch(config)#vtp mode transparent
```

Версию VTP можно выбрать командой:

```
Switch(config)#vtp version 2
```

Пример настройки VTP сдерживания:

```
Switch(config)#vtp pruning
Switch(config)#interface fa0/1
Switch(config-if)#switchport mode trunk
Switch(config-if)#switchport trunk pruning vlan except 20 ! Не передавать на этот порт информацию о vlan 20 
```

Чтобы посмотреть состояние VTP на коммутаторе можно воспользоваться командой: `show vtp status`.

## 25. Назначение и терминология протокола STP

Часто случайно или целенаправленно с целью повышения надежности (redundancy) в СПД вносят избыточные связи, в том числе и между коммутаторами, а пакеты второго уровня (фреймы) не имеют поля TTL, что приводит к возможности возникновения бесконечных циклов при их ретрансляции.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/00e43024-2816-428a-a117-284e2c98287b)

Группа протоколов второго уровня (стандарты 802.1D и 802.1t) под общим названием Spanning Tree призвана бороться с зацикливанием в СПД при резервировании физических каналов.

Любой набор комбинаций подключения коммутаторов друг с другом можно представить в виде графа. При чем, если в этом графе есть циклы, то они и являются проблемой. Задача STP сводится к преобразованию изначального графа с циклами, в граф без циклов, также известный как дерево (отсюда и название).

STP домен может находиться в 3 состояниях:

1. Первоначальная STP конвергенция (первое построение дерева из графа)
2. Устоявшееся состояние (нормальный режим работы)
3. Повторная STP конвергенция (после топологических изменений в домене)

STP сообщение называется BPDU (Bridge Protocol Data Unit), в разных состояниях STP домена применяются разные BPDU сообщения. Коммутаторы не ретранслируют BPDU.

В устоявшемся состоянии домена имеется один единственный коммутатор, который является корнем дерева (root bridge).

Порты коммутаторов в STP имеют следующие роли:

1. Корневой (root) - разрешено передавать кадры, ближайший обращенный к корневому мосту
2. Назначенный (designated) - разрешено передавать кадры, обращенный в сторону от корневого моста
3. Альтернативный (alternate) или, иначе, резервный (backup) - запрещено передавать кадры

Порты коммутаторов в STP могут находится в следующих состояниях:

1. Блокировка (blocking) - пока не участвует в пересылке кадров
2. Прослушивание (listening) - принимается решение о возможности участия в пересылке кадров
3. Изучение (learning) - готовится к участию в пересылке кадров
4. Ретрансляция (forwarding) - участвует в пересылке кадров
5. Запрет (disabled) - вообще не участвует в работе, то есть не подключен к СрПД, административно выключен, или не поддерживает STP

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/dff55727-cb9a-4224-80a2-d34705210273)

## 26. STP-конвергенция

STP-конвергенция протекает в три фазы:

1. Выбор корневого моста
2. Выбор корневых портов
3. Выбор назначенных и альтернативных портов

В процессе выборов анализируются следующие параметры:

1. Идентификатор моста (bridge Identifier) - ассоциирован с каждым мостом (коммутатором), должен быть уникален
2. Стоимость пути (path cost) - ассоциирована с каждым портом, оценивается в рамках STP-домена
3. Идентификатор порта (port identifier) - ассоциирован с каждым портом, оценивается в рамках коммутатора

Изначально каждый коммутатор считает себя корневым мостом, но после обмена BPDUs корневым становится мост с наивысшим приоритетом, то есть с наименьшим цифровым значением идентификатора моста. Получается, что при совпадении идентификаторов мостов учитывается MAC-адрес. В дальнейшем корневой мост используется как точка отсчета.

Корневые порты выбираются исходя из стоимости пути к корневому мосту, то есть из суммы условных стоимостей физических каналов, ведущих к корневому мосту. Выбирается путь с минимальной стоимостью. В случае полного совпадения стоимостей учитываются идентификаторы портов. Выбирается порт с наименьшим цифровым значением идентификатора. При совпадении идентификаторов портов учитываются номера портов.

Если из оставшихся портов два связанных порта входят в петлю, то решается, какой из них активировать, а какой зарезервировать и блокировать. Назначенный порт выбирается исходя из наименьшей стоимости пути к корневому мосту. При совпадении стоимости учитывается идентификатор моста. Выбирается порт с наименьшим идентификатором моста.

Роль порта в процессе STP-конвергенции может изменяться неоднократно.

Если какая-либо часть STP-домена претерпела изменение, то оно обнаруживается (регулярный обмен BPDUs) и специальное BPDU (Topology Change Notification) отсылается в сторону корневого моста. Затем корневой мост информирует об изменении топологии все коммутаторы. В результате топология перерассчитывается и резервные пути активируются.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/7564827f-8c13-42c8-a661-0467a5bfab08)

## 27. Модификации протокола STP

Протокол STP имеет следующие основные модификации:

1. RSTP (Rapid STP) (802.1w -> 802.1D) - алгоритм предоставляет возможность ускоренной STP-конвергенции
2. PVST (Per-VLAN Spanning Tree) - проприетарный протокол Cisco, в отличие от 802.1D в каждом из виланов коммутатор рассматривается как независимая сущность, поддерживает ISL-транки, ряд расширений от Cisco (например, PortFast)
3. PVST+ - проприетарный протокол Cisco, поддерживает ISL- и 802.1Q-транки, новые расширения (например, BPDU Guard)
4. RPVST+ (Rapid PVST+) - от PVST+ отличается только тем, что базируется на 802.1w
5. MSTP (Multiple STP) (802.1s -> 802.1Q) - коммутатор как независимую сущность можно отобразить в несколько виланов

Некоторые реализации Ethernet поддерживают механизм Ethernet keep-alive, также позволяющий обнаружить зацикливание (через порт периодически передается специальный «нулевой» кадр типа 9000h с MAC-адресом источника и MAC-адресом назначения, равными MAC-адресу, относящемуся к порту).

## 28. Конфигурирование STP в IOS

В отличие от многих других протоколов, работа STP почти не требует вмешательства.

По умолчанию, STP уже включен, командой `no spanning-tree vlan` можно отключить STP в соответствующих виланах.

Совместимость с 802.1D либо 802.1t контролируют командой `spanning-tree extend system-id` и `spanning-tree pathcost method`.

Пример назначения коммутатора корневым мостом:

```
Switch(config)#spanning-tree vlan 10 root primary diameter 3
```

Пример изменения стоимости пути:

```
Switch(config)#interface fa0/1
Switch(config-if)#spanning-tree vlan 10 cost 123
```

В алгоритме STP применяются некоторые таймеры, например, hello timer - позволяет задать частоту обмена периодическими BPDUs с соседними коммутаторами (по умолчанию 2 s). Для изменения периода срабатывания таймера можно воспользоваться командой:

```
Switch(config)#spanning-tree vlan 40 hello-time 10
```

PortFast - это технология Cisco, которая заключается в незамедлительном переводе порта доступа из состояния блокировки в состояние ретрансляции.

BPDU Guard - заключается в незамедлительном административном выключении находящегося в режиме PortFast порта доступа после приема им BPDU.

Пример настройки PortFast и BPDU Guard:

```
Switch(config)#interface fa0/1
Switch(config-if)#spanning-tree portfast
Switch(config-if)#spanning-tree bpduguard enable
```

Основная команда для просмотра состояния подсистемы STP - это `show spanning-tree`.

## 29. Понятие агрегации каналов

Часто с целями повышения производительности (load balancing) и попутного обеспечения надежности (fault tolerance) применяют технологии под общим названием Link Aggregation или Port Trunking, то есть технологии агрегирования каналов или портов.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/f442882f-0da2-4bd9-99a4-255352e369e6)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/c4f5141e-fd17-474d-ad3e-3f7def73e248)

Суть заключается в формировании из нескольких «параллельных» физических каналов одного логического аппаратного канала - транка, что открывает возможности более гибкого распределении ресурсов задействованных каналов.

С точки зрения STP, транк рассматривается как единая сущность.

Часто при резервировании выделяется связующий канал (primary link). Переход к резервным каналам происходит при стопроцентной загрузке или сбое связующего. Максимальное количество членов транка часто ограничено двумя либо восемью.

Критерии классификации транков:

1. Канал- (порт-), интерфейс- либо станционная ориентированность: per-link (per-port), per-interface, per-node basis
2. Уровень модели OSI: L2, L3 и выше
3. Целевое сетевое оборудование: switch - switch, NIC - switch (обычно резервируют каналы, связывающие сетевые адаптеры серверов с активным сетевым оборудованием, и каналы, связывающие активное сетевое оборудование между собой)
4. Постоянство членства: static, dynamic

## 30. Технологии агрегации каналов

Основные реализации транков:

1. Intel Adaptive Load Balancing (ALB) - per-interface, L3, NIC-switch, static.
2. Broadcom SLB (Smart Load Balancing) - аналог Intel ALB + RLB
3. HP NFT (Network Fault Tolerance) TLB (Transmit Load Balancing) - еще один аналог Intel ALB
4. Nortel MLT (Multi-Link Trunking) - группа проприетарных технологий (и протоколов) - per-link + per-interface, L2 + L3, switch-switch, static + dynamic
5. SLA (Static Link Aggregation) (802.1AX) - ставший стандартом вариант технологии Cisco FEC (Fast EtherChannels) и GEC (Gigabit EtherChannels) - per-link, L2, switch-switch либо NIC-switch, static (все «вручную» объединяемые в транк пары связанных портов должны быть идентичными (скорость, режим, виланы, состояние и другое), обеспечивается разделение трафика, сбойный канал исключается из группы)
6. LACP (Link Aggregation Control Protocol) (802.1AX) - в отличие от SLA, dynamic (позволяет автоматизировать формирование транков из пар портов на которых включена поддержка этого протокола)
7. Cisco Port Aggregation Protocol (PAgP) - проприетарный протокол в рамках EtherChannels, аналог LACP
8. Microsoft NLB (Network Load Balancing) - поддерживается в серверных редакциях Windows - per-node, L2 + L3 + L4, NIC-switch, static
9. Microsoft NIC Teaming - поддерживается в Windows Server 2012-2019 - per-link + per-interface, L2 + L3, NIC-switch, static + dynamic
10. Linux NIC Bonding - per-link + per-interface, L2 + L3, NIC-switch, static + dynamic

## 31. Поддержка агрегации каналов в Windows и Linux

Поддержка агрегации каналов в Windows доступна только в серверных редакциях, заключается в Microsoft NLB и NIC Teaming.

1. Microsoft NLB (Network Load Balancing) - поддерживается в серверных редакциях Windows - per-node, L2 + L3 + L4, NIC-switch, static:

Содержащие по одному-двум сетевым адаптерам серверные станции подключают к коммутаторам произвольным образом, поддержка со стороны коммутаторов не требуется. Несколько режимов, возможно распределение трафика между станциями с учетом программных портов и приоритетов станций.

2. Microsoft NIC Teaming - поддерживается в Windows Server 2012-2019 - per-link + per-interface, L2 + L3, NIC-switch, static + dynamic:

Три режима: Switch Independent, Static Teaming, LACP.

10. Linux NIC Bonding - per-link + per-interface, L2 + L3, NIC-switch, static + dynamic:

Семь разных режимов.

## 32. Конфигурирование EtherChannels

EtherChannels поддерживают SLA, LACP и PAgP в следующих режимах:

1. `on` - SLA
2. `passive` - пассивный LACP
3. `active` - активный LACP
4. `auto` - пассивный PAgP
5. `desirable` - активный PAgP

Интерфейс включают в группу (channel-group) с выбранным номером с помощью команды `channel-group`, при этом необходимо указать режим. Группа создается автоматически при первом обращении к ней.

Важно, что параметры интерфейсов в группе должны быть идентичными (даже текущие скорости). Если параметры интерфейса при включении в группу отличны, либо, если параметры хотя бы одного из интерфейсов в составе группы по какой-либо причине стали отличны, то этот интерфейс, равно как и интерфейс, соединенный с этим интерфейсом, переводится в особое состояние - down (suspended) и индикатор порта начинает гореть оранжевым цветом.

При создании группы автоматически создается и соответствующий виртуальный сетевой интерфейс port-channel. Channel-groups и port-channels связываются по номерам.

Некоторые параметры необходимо задавать на уровне реальных интерфейсов, а некоторые - на уровне виртуального интерфейса. Некоторые параметры автоматически дублируются (как при вводе на уровне реальных интерфейсов, так и при вводе на уровне виртуального интерфейса), а некоторые необходимо дублировать.

EtherChannels могут быть организованы как на втором, так и на третьем уровне.

Пример настройки EtherChannels на втором уровне:

```
Switch(config)#interface range gi0/1-2
Switch(config-if-range)#switchport mode access
Switch(config-if-range)#switchport access vlan 10
Switch(config-if-range)#channel-group 1 mode on
Switch(config-if-range)#exit
Switch(config)#interface port-channel 1
```

Пример настройки EtherChannels на третьем уровне:

```
Switch(config)#interface range gi0/3-4
Switch(config-if-range)#no switchport
Switch(config-if-range)#channel-group 2 mode active
Switch(config-if-range)#exit
Switch(config)#interface port-channel 2
Switch(config-if)#no switchport
Switch(config-if)#ip address 192.168.0.1 255.255.255.0
Switch(config-if)#exit
```

Для просмотра информации о EtherChannels используется команда `show etherchannel`.

## 33. Понятие кластеризации активного сетевого оборудования

Отказ активного сетевого оборудования может происходить по самым разным причинам в самых разных частях СПД. Отказ того или иного промежуточного маршрутизатора в звене связанных маршрутизаторов вполне успешно разрешается, например, за счет динамической маршрутизации. Но отказ одного из граничных маршрутизаторов, обращенного к DTE и в рядовом случае являющегося для DTE шлюзом по умолчанию, порождает проблемы, поскольку, в отличие от специализированного сетевого оборудования, пользовательские станции как правило не обременяют поддержкой соответствующих протоколов.

Для защиты от подобных неполадок из группы маршрутизирующих устройств формируют кластеры (router clusters), которым назначают виртуальные IP-адреса (и соответствующие виртуальные MAC-адреса из специальных диапазонов).

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/380fbc37-ce9a-4f8d-9c23-9a7f660db2a2)

Существуют технологии, позволяющие формировать кластеры и из коммутаторов.

## 34. Технологии кластеризации активного сетевого оборудования

Взаимодействие маршрутизаторов в составе кластера, в том числе назначение активных (master) и резервных (slave) маршрутизаторов, а также балансировка нагрузки, осуществляется посредством группы протоколов третьего уровня под общим названием FHRPs (First Hop Redundancy Protocols).

Основные протоколы для роутеров:

1. IRDP (ICMP Router Discovery Protocol) - устаревший протокол для обнаружения маршрутизаторов посредством ICMP
2. VRRP (Virtual Router Redundancy Protocol) - протокол резервирования маршрутизаторов путем объединения их в виртуальный маршрутизатор. VRRPv3 отличается от VRRPv2 поддержкой не только IPv4, а и IPv6
3. Cisco HSRP (Hot Standby Router Protocol) - протокол «горячей» замены маршрутизатора. Поддерживаются IPv4 и IPv6
4. Cisco GLBP (Gateway Load Balancing Protocol) - протокол балансировки нагрузки между шлюзами. HSRP + балансировка нагрузки. Поддерживаются IPv4 и IPv6

Основные технологии для коммутаторов:

1. Intel Adapter Fault Tolerance (AFT) - несколько сетевых адаптеров станции подключают к одному коммутатору, поддержка со стороны коммутатора не требуется, в случае отказа текущего связующего адаптера активируется очередной резервный
2. Intel Switch Fault Tolerance (SFT) - два сетевых адаптера станции подключают к разным коммутаторам, поддержка со стороны коммутаторов не требуется, в случае отказа связующего канала активируется резервный
3. HP NFT Only - аналог Intel AFT
4. Cisco & IBM Link-State Tracking - состояние downstream-портов (обращенных в сторону ООД) ставят в зависимость от состояния upstream-портов (обращенных в сторону СПД)
5. Cisco Virtual Switching System (VSS) - на базе высокопроизводительных платформ, использует PAgP
6. Juniper Virtual Chassis - аналог VSS

## 35. Конфигурирование маршрутизирующих кластеров в IOS

Активный маршрутизатор выбирается исходя из приоритета. Приоритет задают числом от 0 до 255. Чем больше число, тем выше приоритет. При равенстве чисел сравниваются IP-адреса. Чем больше IP-адрес, тем выше приоритет. После восстановления маршрутизатора с наивысшим приоритетом после сбоя он опционально снова может гарантированно стать активным (preemption).

Пример настройки HSRP:

```
R1(config)#interface gi0/1
R1(config-if)#standby 1 ip 192.168.0.1
R1(config-if)#standby 1 priority 150
R1(config-if)#standby 1 preempt

R2(config)#interface gi0/1
R2(config-if)#standby 1 ip 192.168.0.1
```

```
R1(config)#interface gi0/1
R1(config-if)#glbp 1 ip 192.168.11.1
R1(config-if)#glbp 1 priority 150
R1(config-if)#glbp 1 preempt
R1(config-if)#glbp 1 load-balancing round-robin

R2(config)#interface gi0/1
R2(config-if)#glbp 1 ip 192.168.11.1
R2(config-if)#glbp 1 load-balancing round-robin
```

Для просмотра состояния кластера используются команды `show standby` и `show glbp`.

## 36. Назначение, использование и альтернативы Cisco Port Security

Port Security - комплекс мероприятий для обеспечения защиты физических портов коммутатора от несанкционированного доступа.

Port Security конфигурируют в отношении индивидуального L2-порта или группы L2-портов (с L3-портами, DTP, EtherChannels и прочим совместимости нет).

После включения Port Security, со ставшим таким образом защищенным портом (secure port) могут ассоциироваться статические и динамические доверительные MAC-адреса (secure MAC addresses), но их суммарное количество не должно превышать установленного максимума. В рамках лимита, доверительными адресами автоматически становятся изученные первыми динамические адреса (в том числе изученные до включения Port Security) и явно указываемые статические адреса (в данном случае приоритета не имеют). Все остальные динамические адреса считаются недоверительными, недоверительные статические адреса в отношении защищенного порта не поддерживаются.

После включения опционального более «серьезного» изучения (sticky address learning) динамические доверительные адреса (в том числе изученные до включения этой возможности) считаются «липкими» (sticky) и, в результате, сохраняются не только в CAM-таблице, а и в рабочей конфигурации. В добавок, можно явно указать какие адреса считать «липкими». «Липкие» адреса не теряются при выключении-включении порта (физическая перекоммутация, административное выключение-включение и так далее).

Можно задать время валидности доверительных адресов.

Если MAC-адрес источника из принятого портом кадра не содержится в окончательно сформированном списке доверительных адресов, то это рассматривается как попытка несанкционированного доступа. В таком случае применяются действия в соответствии с настроенным режимом реагирования:

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/66d8eb0d-88ed-44dd-8dc6-453b8e5f9d17)

Срабатывание Port Security в режиме shutdown переключает порт в особое состояние - down (err-disabled). Для возврата порта в нормальное состояние необходимо административно выключить и затем снова включить порт (shutdown и no shutdown).

Кроме собственно Port Security, есть еще две технологии Cisco для защиты портов: Port Blocking (запрет передачи портом незнакомого юникаст- и мультикаст-трафика) и Protected Ports (трафик между protected-портами запрещен).

## 37. Конфигурирование Cisco Port Security

Пример настройки Port Security:

```
Switch(config)# interface fa0/1
Switch(config-if)#switchport mode access
Switch(config-if)#switchport port-security
Switch(config-if)#switchport port-security violation protect
Switch(config-if)#switchport port-security mac-address 6045.cba7.f876
Switch(config-if)#switchport port-security mac-address sticky ! Внес 6045.cba7.f876 в рабочую конфигурацию
Switch(config-if)#switchport port-security mac-address sticky 7054.d2bf.5b81
Switch(config-if)#switchport port-security aging time 123 ! В минутах
```

Вывести информацию о Port Security можно с помощью команды `show port-security`.

## 38. Назначение и классификация Cisco ACLs

ACLs (Access Control Lists) - это универсальный механизм описания правил фильтрации пакетов, который может быть задействован различными подсистемами маршрутизаторов и коммутаторов.

ACLs делят на три типа:

1. Port ACLs - применимы к L2-интерфейсам (физическим портам)
2. Router ACLs - применимы к L3-интерфейсам (обычным сетевым интерфейсам, SVIs и L3-EtherChannels)
3. VLAN ACLs (VLAN maps) - применимы к виланам

С точки зрения направленности потока пакетов ACLs могут быть:

1. Входными (inbound) - предназначены для фильтрации входящего трафика, проверка происходит еще до маршрутизации
2. Выходными (outbound) - предназначены для фильтрации исходящего трафика, проверка происходит после маршрутизации

C одним интерфейсом одного уровня в одном направлении по одному протоколу может быть связан только один ACL. При повторном связывании, предыдущий ACL вытесняется новым.

С точки зрения синтаксиса ACLs могут быть:

1. Нумерованными (numbered) - идентифицируются уникальными номерами. «Рядовые». Особенны тем, что не подлежат редактированию
2. Именованными (named) - идентифицируются уникальными названиями. Совместимы не со всеми командами. В качестве названий можно присваивать и номера, но согласно правилам для нумерованных ACLs. Особенны тем, что их можно редактировать (в соответствующих режимах конфигурирования добавлять или удалять ACEs)

Выделяют следующие виды ACLs:

1. Стандартные (standard) IP ACLs - позволяют выполнять фильтрацию только на основе IP-адресов источников. Применимы к L2- и к L3-интерфейсам
2. Расширенные (extended) IP ACLs - позволяют выполнять фильтрацию на основе IP-адресов источников, IP-адресов назначения, L4-протоколов и номеров программных портов. Применимы к L2- и к L3-интерфейсам
3. Расширенные MAC ACLs - позволяют выполнять фильтрацию на основе MAC-адресов источников, MAC-адресов назначения и L3-протоколов. Применимы к L2-интерфейсам

## 39. Структура Cisco ACLs

Один отдельно взятый ACL, то есть список, состоит из некоторого количества упорядоченных элементов - ACEs (Access Control Entries). Каждый элемент представляет собой отдельное правило фильтрации. Правило может быть разрешающим (permit) либо запрещающим (deny).

ACL создается после ввода первого его правила. Затем, по мере ввода дополнительных правил, ACEs автоматически дописываются в конец списка. При этом ACEs автоматически последовательно нумеруются начиная с 10 с шагом 10, что открывает возможность вставлять дополнительные ACEs в «нужные места», но редактировать список произвольным образом возможности нет. Номера в рабочей конфигурации не сохраняются, поэтому таковая автоматическая перенумерация происходит и после перезагрузки.

Команда `ip access-list resequence` позволяет автоматически перенумеровать ACEs когда угодно.

## 40. Правила фильтрации в Cisco ACLs и их обработка

Поступивший пакет последовательно, в направлении от начала к концу ACL, сопоставляется с ACEs - вплоть до первого выполнения условия фильтрации. При обнаружении «попадания» пакет дальше не подвергается анализу, то есть либо пропускается, либо отбрасывается. Поэтому порядок ACEs критически важен.

ACL всегда заканчивается неявным запретом. Следовательно, при «непопадании» пакет отбрасывается (при отсутствии ACL, по умолчанию, пакет продвигается без ограничений).

Какая часть IP-адреса должна учитываться при фильтрации, задают с помощью так называемой wildcard-маски: нули соответствуют учитываемым битам, единицы - неучитываемым.

Условия в ACEs могут содержать следующие операторы: eq (equal), gt (greater than), lt (less than), neq (not equal) и range (inclusive range).

Наиболее полные варианты команд для ввода правил ACLs имеют достаточно сложный формат. Более того, набор допустимых аргументов вариативен, то есть наличие и значение некоторых аргументов зависит от наличия и значения других аргументов.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/ab8f4e5b-8c9a-41ee-b725-473b98f83172)

## 41. Нумерованные стандартные IP ACLs и их примеры

Нумерованные ACLs идентифицируются уникальными номерами. Особенны тем, что не подлежат редактированию.

Стандартные ACLs позволяют выполнять фильтрацию только на основе IP-адресов источников. Применимы к L2- и к L3-интерфейсам.

Пример запрета приема трафика от одной станции:

```
Router(config)#access-list 123 deny host 192.168.11.100
Router(config)#access-list 123 permit any
Router(config)#interface fa0/0
Router(config-if)#ip access-group 123 in
```

## 42. Именованные стандартные IP ACLs и их примеры

Именованные ACLs идентифицируются уникальными названиями. Совместимы не со всеми командами. В качестве названий можно присваивать и номера, но согласно правилам для нумерованных ACLs. Особенны тем, что их можно редактировать (в соответствующих режимах конфигурирования добавлять или удалять ACEs).

Стандартные ACLs позволяют выполнять фильтрацию только на основе IP-адресов источников. Применимы к L2- и к L3-интерфейсам.

Пример запрета приема трафика от одной станции:

```
Router(config)#ip access-list standard cool-name
Router(config-std-nacl)#deny host 192.168.11.100
Router(config-std-nacl)#permit any
Router(config-std-nacl)#exit
Router(config)#interface fa0/0
Router(config-if)#ip access-group cool-name in
```

Пример изменения именованного ACL:

```
Router(config)#ip access-list standard cool-name
Router(config-std-nacl)#no 10 ! Удаление deny host 192.168.11.100
Router(config-std-nacl)#11 deny host 192.168.11.111
```

## 43. Нумерованные расширенные IP ACLs и их примеры

Нумерованные ACLs идентифицируются уникальными номерами. Особенны тем, что не подлежат редактированию.

Расширенные IP ACLs позволяют выполнять фильтрацию на основе IP-адресов источников, IP-адресов назначения, L4-протоколов и номеров программных портов. Применимы к L2- и к L3-интерфейсам.

Пример запрета обращений станций из подсети к серверу по протоколу HTTP:

```
Router(config)#access-list 199 deny tcp 192.168.0.0 0.0.0.255 host 192.168.0.100 eq www
Router(config)#access-list 199 permit tcp any any
Router(config)#interface fa0/0
Router(config-if)#ip access-group 199 out
```

## 44. Именованные расширенные IP ACLs и их примеры

Именованные ACLs идентифицируются уникальными названиями. Совместимы не со всеми командами. В качестве названий можно присваивать и номера, но согласно правилам для нумерованных ACLs. Особенны тем, что их можно редактировать (в соответствующих режимах конфигурирования добавлять или удалять ACEs).

Расширенные IP ACLs позволяют выполнять фильтрацию на основе IP-адресов источников, IP-адресов назначения, L4-протоколов и номеров программных портов. Применимы к L2- и к L3-интерфейсам.

Пример запрета обращений станций из подсети к серверу по протоколу HTTP:

```
Router(config)#ip access-list extended cool-name
Router(config-ext-nacl)#deny tcp 192.168.0.0 0.0.0.255 host 192.168.0.100 eq www
Router(config-ext-nacl)#permit tcp any any
Router(config)#interface fa0/0
Router(config-if)#ip access-group cool-name out
```

Пример изменения именованного ACL:

```
Router(config)#ip access-list extended cool-name
Router(config-std-nacl)#no 10 ! Удаление deny tcp 192.168.0.0 0.0.0.255 host 192.168.0.100 eq www
Router(config-std-nacl)#11 tcp 192.168.0.0 0.0.0.127 host 192.168.0.100 eq www
```

## 45. Правила и примеры привязки классических ACLs

Основное правило при выборе места для ACL заключается в том, что список нужно помещать туда, где он наиболее эффективен, то есть наилучшим образом сдерживает нежелательный трафик.

Cisco предлагает два правила размещения ACLs:

1. Расширенные ACLs нужно располагать как можно ближе к источнику нежелательного трафика
2. Стандартные ACLs нужно располагать как можно ближе к защищаемым станциям

ACL обязательно нужно привязать к чему-либо (интерфейсу/линии), иначе ACL не имеет смысла.

Примеры привязки ACLs к интерфейсу:

```
Router(config)#interface fa0/0
Router(config-if)#ip access-group 123 in
Router(config-if)#ip access-group cool-name out
```

При привязке к линии вместо `access-group` используется `access-class`.

## 46. VLAN maps и их примеры

Карта VLAN map предназначена для отображения одного либо нескольких ACLs в один либо несколько виланов. Карта указывает действие (forward - по умолчанию, либо drop), которое нужно совершить с пакетом при попадании, то есть «срабатывании» одного из списков ACL (под «срабатыванием» ACL здесь понимают «срабатывание» именно одного из разрешающих правил; следовательно явные запрещающие правила практически не имеют смысла, разве что ускоряют обработку ACL при большом числе специфических разрешающих правил).

Если ни один из списков ACL «не сработал» то пакет неявно отбрасывается.

Карту идентифицируют названием и номером. Номер позволяет объединять отдельно взятые карты с одинаковыми названиями - по аналогии с ACEs в ACL (если номер не указан, то присваивается автоматически с шагом 10). Название используют при привязке карты к виланам.

Для просмотра карт используют команду `show vlan access-map`.

Пример конфигурации VLAN maps:

```
Switch(config)#ip access-list standard cool-list
Switch(config-std-nacl)#permit host 192.168.0.3
Switch(config-std-nacl)#exit
Switch(config)#access-list 123 deny host 192.168.0.4
Switch(config)#vlan access-map big-map 10
Switch(config-access-map)#match ip address cool-list
Switch(config-access-map)#action forward
Switch(config-access-map)#exit
Switch(config)#vlan access-map big-map 20
Switch(config-access-map)#match ip address 123
Switch(config-access-map)#action drop
Switch(config-access-map)#exit
Switch(config)#vlan filter big-map vlan-list 2 ! VID = 2
```

## 47. IPv6 ACLs и их примеры

IPv6 ACLs ещё в разработке.

Ключевые отличия IPv6 ACLs от IPv4 ALCs:

1. Только именованные, причем только расширенные
2. Привязывают к интерфейсу командой ipv6 traffic-filter
3. Используют не wildcard-маски, а IPv6-префиксы
4. Перед неявным запретом в самом конце, есть еще два неявных разрешающими правила: `permit icmp any any nd-na` и `permit icmp any any nd-ns`

Пример (запрет TCP между `fe80:0:0:2::/64` подсетью к любым хостам с портом больше 1000):

```
Switch(config)#ipv6 access-list cool-access-list
Switch(config-ipv6-acl)#deny tcp fe80:0:0:2::/64 any gt 1000
Switch(config-ipv6-acl)#permit ipv6 any any
Switch(config-ipv6-acl)#exit
Switch(config)#interface gi0/1
Switch(config-if)#no switchport
Switch(config-if)#ipv6 traffic-filter cool-access-list in
Switch(config-if)#exit
```

## 48. Комплексные ACLs и их примеры

Стандартные и расширенные ACL могут быть основой для комплексных ACL для улучшения функциональности.

Можно выделить некоторые дополнительные возможности ACLs:

1. Правило для фильтрации TCP-трафика может содержать флаг `established` - говорит о том, что правило будет применяться только к TCP-соединениям находящимся в таковом состоянии. Если флаг ACK в TCP-сегменте не установлен, то считается, что соединение устанавливается (например, извне) и сегмент отбрасывается.

```
R1(config)#access-list 10 tcp any eq 80 192.168.0.0 0.0.0.255 established
R1(config)#int gi0/0
R1(config-line)# ip access-group 10 in
```

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/618f138e-c923-4830-a782-6a14199ce230)

2. Идея рефлексивных ACLs заключается в том, чтобы для некоторого правила некоторого ACL автоматически активировать его особым образом описанное «обратное» правило другого ACL, «открывающее дверь» для ответного трафика.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/98d72956-0888-41a4-a4c6-d2111360c63d)

3. Идея динамических ACLs (по-другому, Lock-and-key) заключается в том, чтобы автоматически активировать на некоторое время подготовленное правило (placeholder) (только одно) некоторого ACL по условию. Условием является успешность аутентификации посредством Telnet либо SSH.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/59e277f7-dae5-457c-893f-310804b10599)

4. ВременнЫе ACLs, в отличие от динамических, срабатывают по расписанию. В правило включается предварительно подготовленное макро time-range.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/90528585-4f41-4420-8939-b51f2787f5a6)

## 49. Port Mirroring и Storm Control, их примеры

Port Mirroring - дублирование входящих или исходящих кадров определенного физического порта на другом порте. у Cisco аналогичная технология именуется SPAN (Switched Port ANalyzer). Также есть RSPAN (Remote SPAN).

Пример Port Mirroring:

```
Switch(config)#monitor session 1 source interface fa0/1
Switch(config)#monitor session 1 destination interface fa0/2
```

Существуют технологии сдерживания штормов кадров под обобщенным названием Storm Control. Под штормом понимают большое количество бродкаст, мультикаст и неизученных юникаст сообщений, приходящих на порт. Storm Control настраивается индивидуально для всех трех видов трафика. Также настраивается какое действие необходимо совершить при обнаружении шторма. Можно указать один или два уровня порога: для отключения порта при обнаружении шторма, и уровень, при котором порт должен быть включен обратно.

Пример:

```
Switch(config-if)#storm-control multicast level 30.00 10.00
Switch(config-if)#storm-control action shutdown
Switch(config)#errdisable recovery cause storm-control
```

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/0fec2bc6-9c74-42e6-acf6-174cb5d9fe1e)

## 50. Протоколы для активного сетевого оборудования одного производителя и стекирование коммутаторов, их примеры

Разработаны протоколы, позволяющие активному сетевому оборудованию одного производителя определять наличие друг друга. Применительно к оборудованию Cisco, соответствующий протокол называют CDP (Cisco Discovery Protocol).

Стекирование позволяет объединить несколько коммутаторов (обычно одинаковых) в единую сущность - с целью наращивания количества портов.

Наряду с традиционным стекированием посредством специальных разъемов как правило расположенных на задней панели, все большее распространение получает стекирование посредством Ethernet-портов с высокой пропускной способностью (расположенных на передней панели), а так же «чисто» виртуальное стекирование.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/affb4069-c714-435d-a0d0-15c5e8d473ba)

Обычно стек состоит из идентичных коммутаторов (homogeneous stack), но может состоять из коммутаторов разных моделей одной серии или из коммутаторов разных, но совместимых серий (mixed stack).

Обычное физическое стекирование осуществляют с помощью стековых портов (stack ports). По сути, стековые порты - это разъемы для соединения ASICs разных коммутаторов. Стековые порты устанавливают парами. Использование обоих стековых портов позволяет обеспечить полноценную пропускную способность и, заодно, резервирование. Согласно правилам хорошего тона, стековые порты следует соединять кольцом.

Взаимодействие через стековые порты осуществляется по специальному протоколу (stack protocol). Каждый коммутатор в составе стека должен иметь уникальный номер (stack member number). Центром администрирования и управления стеком является один из коммутаторов - стек-мастер.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/3b295cbf-a722-4629-afa6-5e5e5ac64b26)

## 51. Конфигурирование стека коммутаторов в IOS

Центром администрирования и управления стеком является один из коммутаторов - стек-мастер. Системные настройки стек-мастера относятся ко всему стеку. Стек-мастер выбирается автоматически исходя из приоритета (stack member priority). По умолчанию приоритет равен единице, Приоритет задают числом от 1 до 15.

Стек-мастером становится коммутатор с наибольшим цифровым значением приоритета. При равенстве приоритетов учитываются конфигурации портов. Выбирается коммутатор с конфигурацией портов, отличной от конфигурации портов по умолчанию. При наличии нескольких таковых коммутаторов учитываются лицензии. Выбирается коммутатор с самой «старшей» лицензией. Ну и в последнюю очередь, учитываются MAC-адреса. Выбирается коммутатор с наименьшим MAC-адресом.

Идентификатор моста (включая MAC-адрес) всего стека равен идентификатору моста стек-мастера. Командой `stack-mac persistent timer` текущий MAC-адрес стека можно сделать персистентным на некоторое время (чтобы удерживался после сбоя стек-мастера).

Пример конфигурации стека:

```
Switch(config)#switch 1 priority 15
Switch(config)#switch 1 renumber 2
Switch(config)#stack-mac persistent timer 0 ! 0 - бесконечное время
Switch(config)#interface gi2/0/1
```

## 52. Семейство стандартов Wi-Fi

Основой для построения беспроводных ЛКС - Wireless LANs (WLANs) - является семейство стандартов IEEE 802.11, определяющих правила взаимодействия беспроводных устройств и известных под общей аббревиатурой Wi-Fi (Wireless Fidelity). Для продвижения и сертификации оборудования беспроводных ЛКС в 1999 г. был создан WiFi Alliance.

| WiFi            | Каналы                | Модуляция        | Скорость       | Ориентировочная дальность |
| --------------- | --------------------- | ---------------- | -------------- | ------------------------- |
| 802.11b (1999)  | 2.4 GHz               | DSSS             | 11 Mbit/s      | до 30м (типовые условия)  |
| 802.11a (1999)  | 5 GHz                 | OFDM             | 54 Mbit/s      | меньше 802.11b            |
| 802.11g (2003)  | 2.4 GHz               | DSSS-OFDM        | 54 Mbit/s      | примерно как у 802.11b    |
| 802.11n (2009)  | 2.4 GHz, 5 GHz        | MIMO             | 600 Mbit/s     | больше 802.11b            |
| 802.11ac (2013) | 5 GHz                 | SU-MIMO, MU-MIMO | 1.3-6.9 Gbit/s | примерно как у 802.11n    |
| 802.11ax (2019) | 2.4 GHz, 5 GHz, 6 GHz | SU-MIMO, MU-MIMO | 9.6 Gbit/s     | больше 802.11ac           |

## 53. Физический уровень Wi-Fi

Устроен очень сложно. 

В отличие от Ethernet, переход от канального уровня к физическому предполагает дополнительную инкапсуляцию и заключается в том, что CSMA/CA задействует PLCP (Physical Layer Convergence Protocol). При этом MPDUs (собственно кадры Wi-Fi) вкладываются в PPDUs (PLCP Protocol Data Units) в качестве PSDUs (PLCP Service Data Units).

Формат PPDU очень вариативен, однако базой служит формат протокола 802.11: в каждом кадре есть преамбула, хедер и данные PSDU.

PLCP-преамбула состоит из предопределенных соответствующим образом модулируемых символов (symbols) разной длительности (коротких или длинных). Кроме символов для синхронизации, преамбула может содержать разграничитель начала кадра.

В PLCP-заголовке содержатся специальные поля, описывающие процесс передачи PSDU.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/8d8ac060-835d-4082-9bdd-9f96839ba088)

Начиная с 802.11n, поддерживается агрегация PDUs, причем в двух формах: A-MSDU (Aggregate MSDU) и A-MPDU (Aggregate MPDU).

## 54. Каналы Wi-Fi

Используют четыре частотные области (bands): 2,4, 5, 6 и 60 GHz.

Области 2,4 и 5 GHz известны как ISM (Industrial, Scientific and Medical) и освоены в первую очередь.

В области 5 GHz четко выражены три поддиапазона (sub-bands).

Базовый алгоритм Wi-Fi предполагает использование в качестве канала одной более или менее узкой полосы частот. Каналы могут быть шириной примерно 20 (как в 802.11b), 40, 80 и 160 MHz. «Распараллеливание» реализуют не одновременным использованием нескольких каналов, а агрегацией каналов.

Обобщенно, один канал представлен одной несущей (carrier). Однако, по правилам модуляции OFDM, несущую делят на множество поднесущих (subcarriers) - от 64 в каналах шириной 20 MHz до 512 в каналах шириной 160 MHz. Увеличение ширины канала позволяет увеличить количество поднесущих и, следовательно, скорость.

Допустимо перекрытие (overlap) каналов, что актуально в отношении сложно организованных и конфликтующих беспроводных сегментов. Но на практике перекрытие каналов порождает проблемы, поэтому его следует избегать.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/16b0001c-1180-45df-9f60-34328ff5e92a)

Наборы каналов вариативны, так как на использование тех или иных каналов в разных странах наложены свои ограничения. При изготовлении беспроводного оборудования производители закладывают (на аппаратном уровне) поддержку целевого региона (regulatory domain). Изначально выделяли североамериканский, европейский и японский регионы. Подключаемое беспроводное устройство согласует регион с помощью управляющих кадров со специальным информационным элементом в поле данных.

## 55. Модуляция и кодирование в рамках Wi-Fi

1. PPM (Pulse Position Modulation) - модуляция позициями импульсов
2. FHSS (Frequency Hopping Spread Spectrum) - широкополосная модуляция со скачкообразным изменением частоты
3. DSSS (Direct Sequence Spread Spectrum) - широкополосная модуляция с прямым расширением спектра
4. BPSK (Binary Phase Shift Keying) и QPSK (Quadrature Phase Shift Keying) - соответственно двоичное и квадратичное манипулирование фазовыми сдвигами
5. DBPSK (Differential BPSK) и DQPSK (Differential QPSK) - дифференциальные варианты BPSK и QPSK
6. CCK (Complementary Code Keying) - манипулирование дополнительными кодами
7. BCC (Binary Convolutional Coding) - двоичное сверточное кодирование
8. OFDM (Orthogonal Frequency Division Multiplexing) - мультиплексирование c ортогональным частотным разделением
9. OFDMA (Orthogonal Frequency Division Multiple Access) - множественный доступ c ортогональным частотным разделением
10. QAM (Quadrature Amplitude Modulation) - квадратурная амплитудная модуляция
11. MIMO (Multiple Input, Multiple Output) - множественный ввод-вывод (с использованием нескольких антенн)
12. SU-MIMO (Single-User MIMO) - однопользовательский вариант MIMO
13. MU-MIMO (Multi-User MIMO) - многопользовательский вариант MIMO

Физическая модуляция сильно переплетена с канальным кодированием в отношении PPDU. Канальное кодирование может быть как проявлением модуляции, так и дополнительным преобразованием данных. Модуляция и кодирование могут быть многоуровневыми. Поддержка той или иной модуляции (кодирования) может быть как обязательной, так и опциональной. С учетом совместимости, модуляция (кодирование) автоматически подбирается в зависимости от требующейся скорости.

## 56. Стандарты беспроводной связи, кроме Wi-Fi

WiFi - пример технологии WLAN, также есть WWAN, WMAN, WPAN и другие.

1. Satellite broadband - спутниковая связь; скорость ориентировочно до 10 Mbit/s
2. Cellular broadband - мобильная связь; поддержка доступна начиная со второго поколения мобильных телефонов (2G): 2G, 3G, 4G, 5G
3. WiMAX (Worldwide Interoperability for Microwave Access) - для городских и глобальных сетей; 802.16; расстояние до 50 km; скорость до 1 Gbit/s
4. Bluetooth - для персональных сетей; 802.15; три версии; расстояние до 100 m (long range), до 10 m (ordinary range), до 10 cm (short range); скорость до 24 Mbit/s
5. NFC (Near-Field Communication) - для широкого применения на очень коротких расстояниях; до 10 cm; скорость до 0,5 Mbit/s

## 57. Антенны для беспроводного сетевого оборудования и сопутствующие расчеты

Антенна излучает энергию во всех направлениях, но неравномерно. Основным параметром, определяющим эффективность антенны в определенном направлении является диаграмма направленности - зависимость мощности излучения от пространственных координат. Примером может служить диаграмма направленности параболической антенны:

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/82e55330-43cc-4864-b3fe-84c6837bd86a)

Основой устойчивой связи является прямая видимость между передающей и принимающей антеннами. При передаче в эфир, ключевую роль в поглощении волн в атмосфере играет вода в том или ином виде. Дождь, снег или туман могут существенно ухудшить качество связи. В добавок, на более низких частотах влияют в основном грозовые разряды, а на более высоких - космическое излучение.

Затухание радиоволн в беспрепятственной воздушной среде рассчитывают по упрощенной формуле:

```
L = 32,44 + 20lg(F) + 20lg(D) (dB)
```

где F - частота в GHz; D - расстояние (в метрах).

Типичный Wi-Fi-передатчик имеет мощность около 20 dBm на всех используемых частотах, типичный приемник имеет чувствительность около -80 dBm. Это обеспечивает запас по затуханию около 100 dB. Типичная Wi-Fi-антенна дает дополнительное усиление до 6 dBi (если антенна подключена через кабель, то и в кабеле возникает небольшое затухание).

При расчетах нужно также учитывать, что просто размещение подключаемого мобильного устройства относительно антенны уже может дать затухание около 5 dB.

Типы антенн:

1. Omnidirectional - всенаправленные (для применения на открытых пространствах)
2. Dipole - дипольные (позволяют корректировать направленность)
3. Directional - направленные (для применения в ограниченных пространствах), включая:
- patch - патч-антенны или, по-другому, полосковые (для применения при небольшой дальности)
- yagi - так называемые «яги» или, по-другому, «волновой канал» (для применения при повышенной дальности)

## 58. Назначение и классификация беспроводного сетевого оборудования

Беспроводное сетевое оборудование делят на три типа:

1. Для домашних и офисных КС
2. Для распределенных и городских КС
3. Для беспроводных каналов связи

Кроме того, в отличие от проводного сетевого оборудования, оно может быть не только indoor, а и outdoor.

Первым шагом в истории беспроводной компьютерной связи стали радиомодемы.

В дальнейшем, специфика беспроводных сетей привела к возникновению нового типа активного сетевого оборудования - точек доступа (access points). Точки доступа предназначены для интеграции беспроводных и традиционных проводных сегментов. Все современные точки доступа, по сути, являются беспроводными маршрутизаторами, то есть маршрутизаторами, в которых кроме проводных сетевых интерфейсов имеются беспроводные.

Точки доступа делят на два типа:

1. Автономные (autonomous, stand-alone, heavy) - самодостаточны в смысле работоспособности и администрирования
2. Так называемые легковесные (lightweight) - администрируют централизованно посредством контроллеров - WLCs (Wireless LAN Controllers)

Некоторые могут работать и в том, и в другом режиме.

WLCs позиционируют как средство для облегчения администрирования при массовом использовании точек доступа.

В сегменте SOHO приобрели популярность медиацентры, сочетающие в себе функции точек доступа, маршрутизаторов, медиапроигрывателя и других устройств.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/a7459c21-b490-4adf-98fe-50ff191fa037)

## 59. Структура беспроводной сети

В основу беспроводных сетей (не только Wi-Fi) положена так называемая сотовая структура. СПД может состоять из одной либо нескольких сот. Каждая сота управляется персональной точкой доступа.

Точка доступа и ассоциированные с ней беспроводные пользовательские устройства образуют базовую зону обслуживания - BSS (Basic Service Set).

Точки доступа многосотовой сети взаимодействуют между собой посредством распределенной системы - DS (Distribution System). DS - это обычная проводная инфраструктура второго уровня.

Совокупность BSSes и DS образует расширенную зону обслуживания - ESS (Extended Service Set).

Для обеспечения возможности перемещения мобильных беспроводных пользовательских устройств из одних сот в другие предусмотрен роуминг.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/e09834e1-ec84-495d-846b-af91e0109639)

Если же два беспроводных пользовательских устройства взаимодействуют не посредством точки доступа, а напрямую - режим ad hoc, то образуется независимая базовая зона обслуживания - IBSS (Independent BSS).

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/4d48450a-f170-4833-acf7-11b7b85e4888)

Все соты имеют общий уникальный идентификатор SSID, плюс каждая из сот имеет собственный уникальный идентификатор BSSID. SSID вкладывается в поле данных при формировании управляющего кадра как один из информационных элементов.

## 60. Идентификация и виланы в беспроводных сетях

Концепция виланов вполне совместима с WLANs, правда с учетом особенностей.

Беспроводные виланы представлены различными SSIDs, сосуществующими в рамках одной ESS. При рассмотрении классического порта доступа подразумевают, что стационарная пользовательская станция имеет доступ только к одному физическому порту, однако «спрятать» от мобильной пользовательской станции доступные SSIDs невозможно.

Точка доступа должна ставить в соответствие беспроводные виланы (SSIDs) проводным (VIDs), следовательно, должна работать в режиме моста.

Для управления самой точкой доступа создают административный вилан. Вне административного вилана может быть создан отдельный вилан, посредством которого легковесная точка доступа взаимодействует с WLC.

Для обеспечения защиты информации предусмотрен комплекс мер, отчасти выраженный в WEP (Wired Equivalent Privacy) и WPA (Wi-Fi Protected Access).

## 61. Развертывание беспроводной сети

1. На основании имеющихся предпосылок выбрать беспроводную технологию
2. Определить наличие ранее установленных WLANs в непосредственной близости, определить зоны их покрытия и частоты
3. Экспериментальным или другим способом определить необходимое количество точек доступа (лучше, чтобы каждая точка доступа обслуживала менее десяти мобильных или стационарных беспроводных пользовательских станций)
4. Окончательно определиться с беспроводной технологией
5. Установить точки доступа с учетом наилучшего покрытия и интерференции, подключить их к проводным сегментам (лучше обеспечить некоторое перекрытие BSSes)
6. Выполнить базовую настройку точек доступа (задать IP-адреса, частоты, идентификаторы зон обслуживания и так далее)
7. Настроить права доступа на точках доступа (если требуется, шифрование - WPA2, аутентификацию - локальную или RADIUS/TACACS, списки MAC-адресов и другое)
8. Настроить дополнительные сетевые сервисы на точках доступа (обычно DHCP или NAT)
9. Наконец, настроить пользовательские станции (в соответствии с предыдущими пунктами)

## 62. Беспроводное сетевое оборудование Cisco

беспроводное оборудование Cisco делят на пять основных категорий:

1. Indoor access points
2. Outdoor Industrial access points
3. Wireless controllers
4. Cloud-managed access points
5. Controllerless access points

Cisco выкупила компанию Aironet, специализирующуюся на enterprise/industrial решениях. Также выкупила компанию Linksys, ориентированную на SOHO/SMB. Беспроводной маршрутизатор WRT300N, использующийся в лабах, сейчас как раз под этой маркой.

Cisco Meraki Cloud Managed включает в себя 3 основных компонента:

1. MR Cloud Managed Wireless APs - управляемые из облака беспроводные точки доступа серии MR
2. Meraki Cloud Controller (MCC) - контроллер на базе облака
3. Web-based Dashboard - панель управления на основе web-интерфейса

## 63. Беспроводные технологии Cisco

Технология Cisco CleanAir позволяет обеспечить интеллектуальное сосуществование точки доступа с другими точками доступа в «агрессивном» окружении, решая проблему интерференции.

Технология Cisco OfficeExtend позволяет защищенным образом связать WLAN удаленного офиса и основную корпоративную WLAN.

Технология Cisco Wireless Mesh позволяет без усилий строить на базе расставленных в outdoor-окружении специальных точек доступа полнофункциональную сеть с произвольной физической топологией, динамически формировать каналы, находить ближайший WLC, оптимизировать трафик (своеобразная динамическая маршрутизация). Для этих целей разработан новый протокол - AWPP (Adaptive Wireless Path Protocol).

Все вышеперечисленное «собрано» в архитектуру Cisco Unified Wireless Network.

Архитектура Cisco Meraki Cloud Managed включает три основных компонента:

1. MR Cloud Managed Wireless APs - управляемые из облака беспроводные точки доступа серии MR
2. Meraki Cloud Controller (MCC) - контроллер на базе облака
3. Web-based Dashboard - панель управления на основе web-интерфейса

## 64. Конфигурирование беспроводного маршрутизатора Linksys

*Вот это пиздец, тут надо рисовать картинки GUI.*

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/d735cd18-1e86-45be-87b9-6c773b6584a9)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/02ca4f6f-c009-41af-b506-0bc78a4c7101)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/561d407e-a90f-4036-abbc-eaa397b8c6a9)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/6e53b2dd-dfd7-4d88-972a-4c30c4fbeb39)

## 65. Интеграция компьютерных сетей в системы связи

Исторически происходила интеграция компьютерных сетей в системы связи, однако существуют и обратные технологии, подразумевающие интеграцию систем связи в компьютерные сети, например, VoIP.

Для передачи речи была установлена полоса частот 300 - 3400 Hz (4 kHz), что соответствует девяностопроцентному уровню разборчивости.

Для передачи голосовых сообщений вводится понятие канала тональной частоты (ТЧ-канал, voice channel).

В системах аналоговой связи применяют мультиплексирование с частотным разделением каналов - Frequency Division Multiplexing (FDM). Таким образом в результирующем объединенном сигнале каждый voice channel занимает полосу частот 4 kHz.

На базе voice channel формируют групповые тракты (voice groups): первичный К-12 (12 ТЧ-каналов, 60 - 180 kHz), вторичный К-6 (60 ТЧ-каналов, 312 - 552 kHz), третичный К-300 (300 ТЧ-каналов, 812 - 2044 kHz) и другие (более или менее стандартизированные).

В свою очередь цифровая связь имеет три фундаментальные отличия от аналоговой:

1. Тактирование (clocking)
2. Сигнализация (signaling)
3. Кадрообразование (framing)

Сигнализация позволяет создавать, отслеживать и удалять физические соединения. Сигнализация бывает внутридиапозонной (in-band) и внедиапазонной (out-of-band). Выделяют два типа сигнализации:

1. CCS (Common Channel Signaling) - управление всеми информационными каналами происходит через один сигнализирующий
2. CAS (Channel Associated Signaling) - для каждого информационного канала предусмотрен персональный сигнализирующий

В системах цифровой связи для преобразования аналоговых сигналов в цифровые применяют импульсно-кодовую модуляцию (ИКМ) - Pulse Code Modulation (PCM). Частота дискретизации при этом 8 kHz, разрядность - 8, а значит пропускная способность такого канала - 64 kbit/s. Таковой канал называют основным цифровым каналом - Digital Signal level 0 (DS0), на его базе построена иерархия цифровой связи.

При использовании DS0 применяется мультиплексирование с временным разделением каналов - Time Division Multiplexing (TDM).

Тайм-слот - непрерывная последовательность битов в смешанном после мультиплексирования потоке. Тайм слоты создают параллельную иерархию: DS0 соответствует TS0 и так далее.

В разных странах DS и T отличаются.

## 66. Структура и синхронизация цифровых сетевых интерфейсов

С точки зрения структуры сетевой интерфейс состоит из следующих элементов:

1. ЦАП и АЦП
2. Кодеки
3. DSUs (Data Service Units) - передатчики и приемники отдельных каналов
4. CSUs (Channel Service Units) - средства контроля целостности потоков и тестирования в каналах (обычно объединены с DSUs)
5. TDMs (Time Division Multiplexers) - мультиплексоры

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/9be5516b-5912-411e-8759-beee6f1f9258)

С точки зрения синхронизации надо учитывать два обстоятельства:

- источники синхронизации могут быть локальными и глобальными, причем в отношении как отдельных мультиплексоров, так и выделенных групп
- элементы синхронизации включаются в передаваемые кадры

Сбои в синхронизации именуют проскальзываниями (slips).

Выделяют 4 режима синхронизации передатчиков и приемников мультиплексоров в составе СПД:

1. Асинхронный - источники синхронизации не связаны между собой и относительно нестабильны (не более одного проскальзывания за 7 секунд). По факту не применяется
2. Плезиохронный - большинство источников синхронизации не связаны между собой, но они относительно стабильны (не более одного проскальзывания за 17 часов). Нашел широкое применение
3. Псевдосинхронный - все источники синхронизации высокостабильны и многие из них привязаны к одному эталонному глобальному источнику (не более одного проскальзывания за 70 суток). Вытесняет плезиохронный
4. Синхронный - все источники синхронизации привязаны к одному эталонному глобальному источнику (проскальзываний фактически нет). Недостижимый идеал

## 67. Плезиохронная и псевдоасинхронная цифровая иерархия

В составе СПД выделяют 4 режима синхронизации передатчиков и приемников мультиплексоров: асинхронный, плезиохронный, псевдосинхронный и синхронный.

Асинхронный режим никогда не применялся из-за своей ненадежности, а синхронный пока не достижим. Наиболее популярными являются плезиохронный и псевдосинхронный, при чем последний вытесняет первый.

Плезиохронная цифровая иерархия - PDH (Plesiochronous Digital Hierarchy) - базируется на электрических средах.

Воплощениями псевдосинхронной цифровой иерархии стали SONET (Synchronous Optical NETwork) в Северной Америке и SDH (Synchronous Digital Hierarchy) в Европе.

Как SONET, так и SDH могут базироваться на электрических - Electrical Signaling (ES) и оптических - Optical Signaling (OS) средах. В качестве первичных цифровых каналов приняты Optical Carrier level 1 (OC-1), Synchronous Transport Signal level 1 (STS-1) и Synchronous Transport Module level 1 (STM-1).

## 68. Абонентское и провайдерское оборудование

Цифровое и аналоговое RAS-, WAN- и связное оборудование, прежде всего, делят на:

1. Абонентское - CPE (Customer Premises Equipment) - устанавливают у потребителя услуг
2. Провайдерское - SPE (Service Provider Equipment) - устанавливают у поставщика услуг и интегрируют в инфраструктуру определенного уровня (например, городского)

Зоны ответственности абонента и провайдера разграничивает демаркационная линия (demarcation point). Где проходит демаркационная линия зависит от законодательства той или иной страны. Физический канал между граничащими CPE и SPE принято называть «последней милей» («last mile») или «локальной петлей» («local loop»).

К абонентскому оборудованию относят модемы, телефонные аппараты и офисные АТС. На стороне абонента может быть и достаточно сложная инфраструктура.

К высокоспециализированному провайдерскому оборудованию относят коммутаторы и модули, устанавливаемые в маршрутизаторы и АТС.

## 69. Последовательные сетевые интерфейсы

Особенностью RASes и WANs является широкое применение последовательных сетевых интерфейсов различной пропускной способности - вплоть до около 50 Mbit/s.

Большинство стандартов в области последовательных интерфейсов разработаны тремя организациями: ANSI, ITU-T, ISO.

Основные моменты, связанные с последовательными интерфейсами:

- в стандартах четко разделены роли DCE (Data Communication Equipment) и DTE (Data Terminal Equipment)
- при непосредственном соединении двух последовательных сетевых интерфейсов имеют смысл только подключения DTE-DCE и DTE-DTE, при этом в первом случае применяют «прямые» кабели, а во втором - кросс-кабели
- DTE и DCE отличаются формой контактов
- практически ни один из протоколов нельзя ассоциировать только с одним видом разъемов
- список цепей для взаимодействия DCE и DTE унифицирован и функционально полон
- цепи могут быть как несбалансированными (unbalanced, single-ended), так и сбалансированными (balanced, differential)
- благодаря более эффективному заполнению полосы пропускания, в СПД значительно чаще применяют именно синхронный, а не асинхронный режим
- в синхронном режиме синхронизация, как правило, осуществляется не путем вставки в информационные цепи синхробайтов, а путем тактирования через отдельные цепи
- в нормальной ситуации источником тактирования является DCE, но иногда эту роль возлагают на DTE (например, при подключениях DTE-DTE)
- тактовый генератор обычно один, но для тактирования предусмотрены несколько независимых цепей: при передаче от DCE, при приеме от DCE, при передаче от DTE, при приеме от DTE; как альтернативу, допускают внешнее тактирование; возможно побитное и побайтное тактирование
- последовательные интерфейсы образуют не только point-to-point-топологии, но и различные point-to-multipoint-топологии
- как и положено, компьютерная информация передается по последовательным интерфейсам в виде пакетов (кадров), при этом возможны канальное кодирование, канальное сжатие и канальное фрагментирование
- отличительной особенностью последовательных интерфейсов является отсутствие MAC-адресов

## 70. Протокол PPP и смежные протоколы

РРР - это протокол второго уровня, который позволяет устанавливать канальное point-to-point-соединение. Затем это соединение может использоваться практически любыми протоколами третьего уровня.

Над PPP концентрируется много протоколов, их можно разделить на несколько групп:

1. LCPs (Link-layer Control Protocols)
2. NCPs (Network Control Protocols)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/b958bc38-b5dc-4516-b37f-e484257dcf66)

Набор NCPs позволяет адаптировать подготовленное соединение к нуждам протоколов третьего уровня и включает: IPCP (IP Control Protocol), IPv6CP, IPXCP, CCP (Compression CP) и так далее.

Собственно LCP (Link Control Protocol) обеспечивает создание, конфигурирование, опциональное тестирование, контроль состояния и закрытие соединения. Под конфигурированием понимают согласование опций инкапсуляции, то есть согласование максимальной длины пакетов, способа аутентификации, способа сжатия и другое. Тем самым происходит адаптация к конкретной СрПД. Работа LCP базируется на механизме запросов-подтверждений.

PPP поддерживает два алгоритма аутентификации на канальном уровне:

1. PAP (Password Authentication Protocol) - «двойное рукопожатие», разовый обмен незашифрованными PAP-сообщениями
2. CHAP (Challenge Handshake Authentication Protocol) - «тройное рукопожатие», периодический обмен зашифрованными CHAP-сообщениями

Еще две серьезные возможности PPP:

1. Multilink - задействование соединением ресурсов нескольких параллельных физических каналов (фрагментация, перемежение, балансировка нагрузки и другое)
2. Bridging - поддержка мостов

## 71. Конфигурирование последовательных сетевых интерфейсов в IOS

Общая:

```
Router(config)#interface se0/0/0
Router(config-if)#clock rate 64000 ! Выбор скорости в битах в секунду
Router(config-if)#encapsulation ppp ! Включение протокола PPP
Router(config-if)#ppp multilink !  Включение мультилинка
```

PAP:

```
R1(config)#username cool-username password 12345
R1(config)#interface se0/0/1
R1(config-if)#encapsulation ppp
R1(config-if)#ppp authentication pap

R2(config)#interface se0/0/0
R2(config-if)#encapsulation ppp
R2(config-if)#ppp pap sent-username cool-username password 12345
```

CHAP:

```
R1(config)#username R2 password 54321
R1(config)#interface se0/1/0
R1(config-if)#encapsulation ppp
R1(config-if)#ppp authentication chap

R2(config)#username R1 password 54321
R2(config)#interface se0/1/1
R2(config-if)#encapsulation ppp
R2(config-if)#ppp authentication chap
```

## 72. Обзор технологии Dial-up и структура Dial-up RAS

Первой широко распространенной технологией подключения удаленных пользователей стала технология Dial-up, ограниченно применяют до сих пор.

Используют сложившуюся телефонную инфраструктуру и соответственно ту же полосу частот, что и телефоны (0-4 kHz).

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/6b24a3e2-59db-40fd-847f-f59e51098765)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/5a65ca38-c274-49c6-a372-92cc863a89c7)

На абонентской стороне устанавливают внутренний либо внешний Dialup-модем, на провайдерской - внутренний либо внешний, аналоговый либо цифровой модемный пул.

Посредником является то, что в настоящее время принято называть традиционной телефонной сетью общего пользования - PSTN (Public Switched Telephone Network) или, по-другому, POTS (Plain Old Telephone Service). PSTN охватывает сеть возможно разных АТС. В настоящее время почти все ATC цифровые и применяют основном цифровые модемные пулы.

Предельной скоростью передачи данных для Dial-up является 56 kbit/s.

## 73. Обзор технологии ISDN и структура ISDN-домена

Первой достаточно широко распространенной полностью цифровой технологией, пришедшей на смену Dial-up и как Dial-up уже устаревшей, стала ISDN (Integrated Services Digital Network). ISDN предназначена для передачи разнородного трафика и эту технологию условно относят к технологиям коммутации цепей.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/c2a3604c-2827-47ce-9697-473931e4eb5c)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/0680d59d-a8c2-49df-8a5d-401fca07e8bd)

В архитектуре и структуре ISDN-домена выделяют четыре плана (control, management, transport, user), для каждого из которых предусмотрены набор интерфейсов и набор устройств: ISDN-модемы, ISDN-коммутаторы и другие (в том числе ISDN-терминал-адаптеры для подключения к ISDN аналоговых оконечных устройств).

Большинство стандартов ISDN разработаны ITU-T.

Сетевые интерфейсы ISDN состоят из каналов следующих видов:

1. D-канал (Delta channel) - используется для сигнализации и контроля
2. B-канал (Bearer channel) - используется для пересылки электронных данных, голоса и видео
3. H-канал (Hybrid channel) - транк из некоторого количества B-каналов

Стандартизированы два вида сетевых интерфейсов ISDN:

1. BRI (Basic Rate Interface) - базовый - типичная схема: 2B + 1D
2. PRI (Primary Rate Interface) - первичный - схема: 23B + 1D либо 30B + 1D

ISDN может обеспечивать скорости до 622 Mbit/s.

## 74. Обзор технологии ATM и структура ATM-домена

Технология ATM (Asynchronous Transfer Mode) базируется на ISDN. ATM условно относят к технологиям коммутации пакетов. Серьезными достоинствами ATM являются заложенные поддержка качества обслуживания разнородного трафика и ориентированность на соединение.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/840c2f4e-7107-484c-9f5b-b200231b0a01)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/e34bcceb-8070-4f54-b201-bed00d11ceed)

ATM-домен (ATM domain) состоит из некоторого количества объединенных ATM-коммутаторов (ATM switches) и подключенных к ним граничных АТМ-устройств (ATM edge devices). Граничными ATM-устройствами могут быть маршрутизаторы, пользовательские станции, коммутаторы с поддержкой ATM и так далее.

Согласно идее ATM, информация передается посредством фиксированной длины кадров, называемых ячейками (cells) (53 байта, 5 байтов заголовок и 48 байтов наполнение.

ATM обеспечивает скорость до 40 Gbit/s и больше.

## 75. Примеры инкапсуляции в ATM-системе

Услугами ATM могут пользоваться самые разные приложения, взаимодействующие по разным семействам протоколов. На граничном ATM-устройстве, поступающие с третьего уровня пакеты могут использовать ATM не только напрямую (native), а и посредством эмуляции MAC-уровня LAN - LANE (LAN Emulation).

Используется многопротокольная инкапсуляция по правилам RFC 2684 (усовершенствование RFC 1483), которая бывает двух видов: LLC (Logical Link Control) и SNAP (Subnetwork Access Protocol). В результате, пакеты разных L3-протоколов могут пересылаться по одной виртуальной цепи.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/a4cd24c1-1a67-4a23-acb0-585e60ebcbca)

## 76. Семейство стандартов xDSL

Одними из наиболее широко применяемых в настоящее время RAS-технологий являются технологии под общим названием xDSL (Digital Subscriber Loop). Семейство xDSL представляет собой «облегченный» вариант ATM,
пришедший, после некоторой паузы, на смену ISDN.

Технологии DSL соответствуют физическому уровню модели OSI и, как и следует из названия, их относят к локальной петле. Задействуется полоса частот выше 4 kHz, поскольку ресурсы медной пары этим не ограничиваются.

В настоящее время семейство стандартов xDSL включает:

1. HDSL (High bit rate DSL)
2. SDSL (Symmetric DSL)
3. SHDSL (Single-pair HDSL)
5. ADSL (Asymmetric DSL)
6. ADSL2
7. ADSL2+
8. ADSL2++
9. VDSL (Very high bit rate DSL)
10. VDSL2

Стандарты различают по: способам модуляции, способам кодирования, способам подавления шумов, частотным диапазонам, скорости и дальности передачи.

| xDSL    | Среда передачи данных | Модуляция | Максимальная скорость, Mbit/s   | Дальность, км |
| ------- | --------------------- | --------- | ------------------------------- | ------------- |
| HDSL    | 2 phone pairs         | CAP       | 2.0 duplex                      | 4.0           |
| SDSL    | 1 phone pair          | ?         | 2.3 duplex                      | 3.0           |
| SHDSL   | 1 phone pair          | TCAMP     | 2.4 duplex                      | 4.0           |
| ADSL    | 1 phone pair          | DMT       | 0.8 up, 8.0 down                | 3.0           |
| ADSL2   | 1 phone pair          | DMT       | 1.0 up, 12.0 down               | 2.0           |
| ADSL2+  | 1 phone pair          | DMT       | 2.0 up, 24.0 down               | 1.5           |
| ADSL2++ | 1 phone pair          | DMT       | 3.0 up, 48.0 down               | 1.0           |
| VDSL    | twisted pair, fiber   | QAM       | 12.0 up, 52.0 down, 26.0 duplex | 1.0           |
| VDSL2   | twisted pair, fiber   | DMT       | 100.0 duplex                    | 0.5           |

## 77. Каналы и модуляция в рамках xDSL

Модуляции:

1. CAP (Carrierless Amplitude and Phase modulation) - нетребующая наличия несущей амплитудно-фазовая
2. TCPAM (Trellis Coded Pulse Amplitude Modulation) - амплитудная с кодированием импульсов решетчатым кодом
3. DMT (Discrete Multi Tone) - дискретная многотональность
4. QAM (Quadratic Amplitude Modulation) - квадратурная амплитудная

С точки зрения организации каналов, нужно разделять:

1. Направление передачи upstream и downstream - соответственно от абонента к провайдеру и наоборот
2. Симметричность (symmetric) и несимметричность (asymmetric) каналов - исходя из двух взаимосвязанных характеристик: частоты канала и возможности задействовать канал в определенном направлении)

Таким образом, можно говорить о трех устоявшихся группах технологий: ADSL (асимметричные), SHDSL (симметричные) и VDSL (гибридные). Но явно доминируют именно ADSL.

В случае с ADSL, по правилам модуляции DMT, данные передаются одновременно по большому количеству (до 256 - ADSL и ADSL2, до 512 - ADSL2+) параллельных каналов (по 4 kHz шириной).

Часть каналов, расположенных в нижней области рабочей полосы частот, используется как upstream, оставшиеся - как downstream.

## 78. Структура xDSL RAS

При подключении по xDSL, и на стороне абонента, и на стороне провайдера, необходимо использование сплиттеров - для исключения взаимовлияния частот PSTN и xDSL.

При использовании xDSL не обойтись без особого типа активного провайдерского сетевого оборудования - DSLAM (DSL Access Multiplexor), предназначенного для агрегирования xDSL-линий. Часто DSLAM мультиплексирует множество xDSL-линий в один Ethernet-канал, при этом упаковывая поступающие от абонентов пакеты в отдельные виланы. На стороне провайдера сплиттеры обычно встроены в DSLAM.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/fb858b5a-9b20-40ec-b148-9a7fc52c181b)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/19bf0530-4028-416d-9eed-a2891084d8a9)

## 79. Примеры инкапсуляции в xDSL-системе

Надстройкой над xDSL является архитектура ATM. Как правило, протоколы третьего уровня задействуют ATM через PPP-прослойку. При этом возможны два варианта, выраженные в соответствующих протоколах:

1. PPPoA (PPP over ATM) - напрямую (но в связке с многопротокольной инкапсуляцией)
2. PPPoE (PPP over Ethernet) - посредством эмуляции Ethernet (так же в связке с многопротокольной инкапсуляцией)

Одним примером может служить xDSL-система, в которой используется PPPoE. PPPoE-клиент установлен на удаленной пользовательской станции, DSLAM работает с виланами:

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/47b5ece0-2d76-4816-9cee-3ed9173f195c)

Другим примером может служить xDSL-система, в которой используется PPPoA. PPPoA-клиент интегрирован в xDSL-модем, DSLAM и RAS связаны по ATM:

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/cf820a6f-811f-4c9a-be3b-5ade662c836a)

## 80. Обзор технологии FR и структура FR-домена

Технология FR (Frame Relay) произошла от X.25 и ISDN. FR не позволяет устанавливать соединения. FR условно относят к технологиям коммутации пакетов.

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/8ca9b612-f43f-478b-ab6d-28f73499318e)

Каки и ATM, базируется на виртуальных каналах.

Поддерживаются как PVCs, так и SVCs.

VCs идентифицируют значимыми только в пределах физических каналов десятибитными идентификаторами DLCIs (Data-Link Connection Identifiers). Значения DLCI от 0 до 15 и от 992 до 1023 зарезервированы. Для сигнализации используется DLCI = 0.

В FR стандартизированы два плана: U-plane (User plane) и C-plane (Control plane).

FR обеспечивает скорость до 50 Mbit/s и больше.

## 81. Виртуальные цепи ATM, FR и подобных технологий

Виртуальная цепь (VC - Virtual Circuit) в приложении к ATM считают синонимом термина виртуальный канал (так же VC - Virtual Channel) и раскрывают как связывающую два абонентских граничных ATM-устройства цепочку под названием VCC (Virtual Channel Connection), состоящую из ограниченных физическими каналами между ATM-портами звеньев под названием VCLs (Virtual Channel Links).

VCs объединяют в группы, называемые VPs (Virtual Paths).

В пределах физического канала может существовать множество VCLs.

Виртуальные цепи ATM и FR бывают трех видов:

1. PVCs (Permanent Virtual Circuits) - и на граничных ATM-устройствах, и на ATM-коммутаторах, пары VPI/VCI администраторы задают статически
2. SVCs (Switched Virtual Circuits) - пары VPI/VCI и таблицы коммутации формируются ATM-коммутаторами динамически и автоматически
3. Soft PVCs - гибриды PVCs и SVCs, связь между граничными ATM-устройствами и ATM-коммутаторами организована по PVC-правилам, а между ATM-коммутаторами - по SVC-правилам.

Для обеспечения возможности создания SVCs со стороны граничных ATM-устройств используется специальный механизм - сигнализация.

## 82. Принцип работы ATM- и FR-коммутаторов

Каждый ATM VCL, а следовательно и VC со стороны абонента, идентифицируют парой:

1. VPI (Virtual Path Identifier)
2. VCI (Virtual Channel Identifier)

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/7dc41c54-8eb8-4ee6-840c-d0704a474e12)

Таким образом, коммутация выполняется исходя из значения VPI/VCI в заголовке ячейки. Пара VPI/VCI значима только в пределах физического канала и поэтому может меняться в процессе пересылки ячейки по ATM-домену.

Значения VCI от 0 до 31 зарезервированы. Ячейки с нулевыми значениями VPI и VCI считаются пустыми.

В FR вместо пары VPI/VCI используется DLCIs (Data-Link Connection Identifiers).

![image](https://github.com/amateomi/VMSiS-networks/assets/74430714/37fd9474-2d2e-4a1c-95d1-94068492b244)

Значения DLCI от 0 до 15 и от 992 до 1023 зарезервированы. Для сигнализации используется DLCI = 0. За мультикаст-группами зарезервированы DLCIs от 1019 до 1022 включительно.

## 83. Протоколы ILMI и ELMI

В ATM для отслеживания состояния VCs между оконечными устройствами и коммутаторами, а также VCs между коммутаторами, был разработан специальный интерфейс-протокол, получивший название ILMI (Integrated Local Management Interface) или просто LMI.

ILMI разработан по образу SNMP и позволяет: определять состояние сетевого интерфейса, определять наличие PVCs (создание, удаление, активность), определять соответствие конфигураций непосредственно связанных устройств, собирать статистику; плюс расширить возможности мультикаст- и глобальной адресации.

ILMI базируется на периодическом обмене сообщениями (keepalives) (по умолчанию 5s).

В FR, так же как и в ATM, имеется LMI, точнее ELMI (Enhanced LMI).

Так же происходит периодический обмен (по умолчанию 10s).

Три стандарта LMI:

1. Annex A - общепромышленный стандарт, задействуется DLCI = 0
2. Annex D - альтернативный общепромышленный стандарт, так же задействуется DLCI = 0
3. «Gang of Four» (= Cisco) - разработан Cisco, DEC, StrataCom и Nortel - задействуется DLCI = 1023
